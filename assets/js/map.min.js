var now=new Date();var hour=("0"+now.getHours()).slice(-2);var minute=("0"+now.getMinutes()).slice(-2);kakekomiMap(hour,minute);function time2minute(a){a=a.split(":");
a=parseInt(a[0],10)*60+parseInt(a[1],10);return a;}var selectHour=document.getElementById("hour");var selectMinute=document.getElementById("minute");var submitSetting=document.getElementById("submit-setting");
selectHour.value=now.getHours();selectMinute.value=Math.floor(now.getMinutes()/10)*10;submitSetting.onclick=function(){var a=selectHour.value;var b=selectMinute.value;
kakekomiMap(a,b);return false;};function kakekomiMap(a,c){var b=parseInt(a,10)*60+parseInt(c,10);d3.csv("data.csv",function(d,f){var j=new google.maps.Map(document.getElementById("map"),{center:{lat:34.2321,lng:135.1911},zoom:11});
var k,h=[];for(var e=0;e<f.length;e++){if(time2minute(f[e].open)<=b&&b<=time2minute(f[e].close)){h.push({location:new google.maps.LatLng(f[e].lat,f[e].lng),weight:10});
}}var g=new google.maps.visualization.HeatmapLayer({radius:100,opacity:0.75});g.setData(h);g.setMap(j);});}