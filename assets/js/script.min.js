var data="data.csv";var now=new Date();var hour=("0"+now.getHours()).slice(-2);var minute=("0"+now.getMinutes()).slice(-2);var map=new google.maps.Map(document.getElementById("map"),{center:{lat:34.2321,lng:135.1911},zoom:11});
kakekomiMap(data,hour,minute);function time2minute(a){a=a.split(":");a=parseInt(a[0],10)*60+parseInt(a[1],10);return a;}var selectHour=document.getElementById("hour");
var selectMinute=document.getElementById("minute");var submitSetting=document.getElementById("submit-setting");selectHour.value=now.getHours();selectMinute.value=Math.floor(now.getMinutes()/10)*10;
submitSetting.onclick=function(){var a=selectHour.value;var b=selectMinute.value;kakekomiMap(data,a,b);return false;};function kakekomiMap(b,a,d){var c=parseInt(a,10)*60+parseInt(d,10);
d3.csv(b,function(e,g){map=new google.maps.Map(document.getElementById("map"),{center:{lat:map.getCenter().lat(),lng:map.getCenter().lng()},zoom:map.getZoom()});
var k,j=[];for(var f=0;f<g.length;f++){if(time2minute(g[f].open)<=c&&c<=time2minute(g[f].close)){j.push({location:new google.maps.LatLng(g[f].lat,g[f].lng),weight:10});
}}var h=new google.maps.visualization.HeatmapLayer({radius:100,opacity:0.75});h.setData(j);h.setMap(map);});}